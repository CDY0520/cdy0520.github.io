---
title: "데이터 유형 관리하기"
date: 2026-02-14 14:50:00 +0900
categories: [Tech, SQL]
tags: [SQL]
---

## 날짜를 문자열로 저장하면 나중에 조회가 안될 수 있다.
편의성을 위해 날짜 데이터를 DATE 타입이 아닌 VARCHAR2(8) 같은 문자열로 관리하는 경우가 종종 있다.  
하지만 이것이 곧 큰 에러로 돌아올 수 있다.
<br>


![날짜 데이터](/assets/img/sql_4-1.PNG)

위 사진을 보면, 문자열로 저장된 hiredate를 날짜로 바꾸려니 에러가 발생했다.  
이러한 문자열 컬럼은 잘못된 날짜(예: 2024-13-32)의 입력을 막지 못한다.  
DATE 타입이었다면 입력 단계에서 차단되었을 데이터가 DB에 쌓여버리게 된다.  
<br>


![날짜 데이터](/assets/img/sql_4-2.PNG)

이미 잘못된 데이터가 들어왔다면 어떻게 해야 할까?  
단순히 TO_DATE만 써서는 에러 때문에 조회가 불가능하다. 이때 필요한 것이 검증 로직이다.  
<br>
위의 사진처럼 PL/SQL을 이용해 날짜 변환이 가능한지 체크하는 ck_date 사용자 정의 함수를 만들어 'Invalid'한 데이터만 골라낼 수 있다.    
<br>


![날짜 데이터](/assets/img/sql_4-3.PNG)

그래서 위쪽 사진처럼 만들어진 사용자 정의 함수를 활용해 필터링 해보면,
유효하지 않은 날짜 값을 가지고 있는 행 14개가 조회되었다.
<br>


![날짜 데이터](/assets/img/sql_4-3.PNG)

최신 오라클 버전이라면 VALIDATE_CONVERSION 함수를 사용하여  
별도의 함수 생성 없이도 유효하지 않은 데이터를 즉시 필터링할 수도 있다.

<hr style="height: 5px; background-color: #777; border: none;">

## 한 걸음 더: 애초에 날짜 데이터를 왜 문자열로 했을까?
처음에는 문자열이 조회할 때 가공하기 편하다는 이유였다.  
하지만 이번 에러를 겪으며 DB의 가장 큰 역할은 데이터 저장뿐만 아니라 '무결성 방어'에 있다는 것을 알게되었다.  
<br>

애초에 날짜는 DATE 타입으로 저장하면 잘못된 값이 아예 들어오지 못하게 막을 수 있을 뿐만 아니라,    
날짜 연산과 인덱스 활용 측면에서도 압도적으로 유리하다.    
<br>

>조회의 편의보다 데이터의 정확성이 우선되어야 한다.  
<br>

만약 잘못 입력된 날짜 하나 때문에 전체 매출 결산 쿼리가 에러로 멈춘다면?  
혹은 존재하지 않는 날짜에 이자가 계산된다면?  잘못된 업무로인해 정말 큰 손실이 발생할 수 있다.  
<br>

>새로운 테이블을 설계할 때 반드시 데이터의 도메인(범위)을 먼저 정의하도록 하자.  
>날짜는 DATE, 숫자는 NUMBER 등 본연의 타입을 유지하는 것을 원칙으로 하며,  
>부득이하게 문자열로 관리되는 레거시 데이터를 다룰 때는 반드시 VALIDATE_CONVERSION 등으로 데이터 정제(Cleaning) 작업을 선행해야겠다.    

<hr style="height: 5px; background-color: #777; border: none;">

## [SUMMARY]
1. 타입의 본질: 가급적 날짜는 DATE 타입을 이용하는 것이 데이터 무결성과 성능 면에서 가장 좋다.
2. 방어적 SQL: 문자열 날짜 컬럼을 다룰 때는 에러 발생 가능성을 항상 염두에 두고, 검증 함수(VALIDATE_CONVERSION 등)를 적극 활용 하자.
3. 무결성이 우선: 개발 편의성 때문에 DB의 검증 능력을 포기하지 말자.
